<!doctype html>
<html>
	<head>
        <meta charset="utf-8"/>
		<title>my canvas
		</title>
		<script src="js/drawTimeLine.js"></script>
		<script src="js/drawStretch.js"></script>
		<script src="js/together.js"></script>
        <style type="text/css">
            canvas{
                width:100%;
                height:100%;
            }
        </style>
		<script type="text/javascript">
            window.onload = function (){
                var canvas = document.getElementById('mycanvas');
                canvas.width = screen.width;
                canvas.height = screen.height;
                var context = canvas.getContext('2d');

                together();
                function together(){


                    var timePoints = ['初始','无知','无畏','已知','惶恐'];
                    var image = new Image();
                    image.src = 'image/me.jpg';
                    image.onload = function (){
                        var timeLine = new TimeLine(canvas,context,'red',100,540,800,6,image,timePoints);
                        timeLine.strokeAll(85,480);
                        var stretch = new Stretch(canvas,context);
                        var together = new Together(stretch,timeLine);
                        var path = [];
                        path.push(function(dir){
                            together.animate(0,0,dir,timeLine.pointsPosition[0].x-15,timeLine.pointsPosition[0].x-15,dir,"一开始的时候我的世界一片黑暗",dir);
                        });
                        path.push(function(dir){
                            var keepPoint = dir==1?0:1;
                            var keepRadius = dir==1?0:50;
                            together.animate(keepRadius,keepRadius,dir,timeLine.pointsPosition[keepPoint].x-15,timeLine.pointsPosition[keepPoint].x-15,dir,"一开始的时候我的世界一片黑暗",dir);
                            setTimeout(function(){
                                together.animate(0,50,dir,timeLine.pointsPosition[0].x-15,timeLine.pointsPosition[1].x-15,dir,"然后学习了一些基本知识",dir);
                            },1000);
                        });
                        path.push(function(dir){
                            var keepPoint = dir==1?1:2;
                            var keepRadius = dir==1?50:100;
                            together.animate(keepRadius,keepRadius,dir,timeLine.pointsPosition[keepPoint].x-15,timeLine.pointsPosition[keepPoint].x-15,dir,"然后学习了一些基本知识",dir);
                            setTimeout(function(){
                                together.animate(50,100,dir,timeLine.pointsPosition[1].x-15,timeLine.pointsPosition[2].x-15,dir,"学到了一定阶段以为自己懂了很多，开始了因为无知的无谓……",dir);
                            },1000);
                        });
                        var now = -1;
                        var move = function(dir){

                            if(dir==0) {

                                if(now<0) return;
                                path[now](dir);
                                now--;
                            }else if(dir==1){
                                now++;
                                if(now>=path.length) {
                                    now--;
                                    return;
                                }
                                path[now](dir);
                            }
                        };
                        document.body.onkeydown = function(e){
                            if(e.keyCode == 37){
                                move(0);
                            }else if(e.keyCode ==39){
                                move(1);
                            }
                        };

                    };

                }



                function stretchCir(){
                    var stretch = new Stretch(canvas,context);
                    stretch.drawBackGround();
                    document.getElementById("one").onclick = function(e){
                        stretch.animate(0,50);
                    };
                    document.getElementById("two").onclick = function(e){
                        stretch.animate(50,100);
                    };
                    document.getElementById("three").onclick = function(e){
                        stretch.animate(100,200);
                    };
                }

                //drawTimeLine();
                function drawTimeLine (){
                    var timePoints = ['2008','2009','2010','2011','2012'];
                    var image = new Image();
                    image.src = 'image/me.jpg';
                    image.onload = function (){
                        var timeLine = new TimeLine(canvas,context,'red',100,540,800,6,image,timePoints);
                        timeLine.strokeAll(85,480);
                        document.getElementById("move").onclick = function(e){
                            timeLine.animate(timeLine.pointsPosition[1].x-15,timeLine.pointsPosition[2].x-15);
                        };
                    };
                }

            };

		</script>
	</head>
	<body>
		<canvas id="mycanvas" ></canvas>
	</body>
</html>
